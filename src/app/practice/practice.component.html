<mat-sidenav-container fullscreen>
  <mat-sidenav mode="side" position="end" class="sidenav" [opened]="true">
    <app-run-timer [timer]="timer"></app-run-timer>
  </mat-sidenav>

  <mat-sidenav-content>
    <div class="page-container">
      <div class="page-header">
        <app-header></app-header>
      </div>
      <div class="page-info">
        <h2 class="page-title">Record Tool</h2>
        <div class="category-container">
          <div class="category">
            <div class="category-button btn-record" [class.btn-record-stop]="timer.runState !== runState.Waiting && !replay"
              (click)="timer.runState !== runState.Waiting && !replay ? stopRecording() : startRecording()">
              {{timer.runState !== runState.Waiting && !replay ? "Stop Recording" : "Start Recording" }}
            </div>
          </div>
          <div class="category">
            <div class="category-button">Load Checkpoint</div>
          </div>
          <div class="category">
            <div class="category-button">Set Checkpoint</div>
          </div>
        </div>
        <hr />

        <div class="category-container">
          <div class="category">
            <div class="category-button subcategory btn-play" [class.btn-play-cancel]="timer.runState !== runState.Waiting" (click)="playAllRecordings()">
              {{timer.runState !== runState.Waiting ? "Cancel" : "Play All" }}
              
            </div>
          </div>
          <div class="category category-select">
            <span>Countdown:</span>
            <input [disabled]="timer.runState !== runState.Waiting" type="number" min="0" [(ngModel)]="timer.countdownSeconds" (change)="timer.reset()">
          </div>
          <div class="category category-select">
            <span>Load on Record:</span>
            <mat-button-toggle-group [(ngModel)]="loadOnRecord" appearance="legacy">
              <mat-button-toggle value="true">On</mat-button-toggle>
              <mat-button-toggle value="false">Off</mat-button-toggle>
            </mat-button-toggle-group>
          </div>
          <div class="category category-select">
            <span>Record with Ghosts:</span>
            <mat-button-toggle-group [(ngModel)]="usePlayback" appearance="legacy">
              <mat-button-toggle value="true">On</mat-button-toggle>
              <mat-button-toggle value="false">Off</mat-button-toggle>
            </mat-button-toggle-group>
          </div>
        </div>

      </div>
      <div class="page-table-container">

        <table mat-table [dataSource]="dataSource" multiTemplateDataRows>
          <ng-container matColumnDef="player">
            <th mat-header-cell *matHeaderCellDef> Playback </th>
            <td mat-cell *matCellDef="let recording">
              <span class="playback" (click)="playRecording(recording.id)">&#x23F5;</span>
              <mat-slider *ngIf="recording.playback.length !== 0" disabled min="0"
                [max]="currentRecording === 'all' || currentRecording === recording.id ? recording.playback[0].time : 0">
                <input matSliderThumb [(ngModel)]="timer.totalMs">
              </mat-slider>
            </td>
          </ng-container>
          <ng-container matColumnDef="time">
            <th mat-header-cell *matHeaderCellDef> Time </th>
            <td mat-cell *matCellDef="let recording"> {{ recording.timeFrontend }} </td>
          </ng-container>
          <ng-container matColumnDef="options">
            <th mat-header-cell *matHeaderCellDef> Remove </th>
            <td mat-cell *matCellDef="let recording"><span class="delete" (click)="deleteRecording(recording.id)">X</span></td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="columns"></tr>
          <tr mat-row *matRowDef="let recording; columns: columns;" class="run-row"></tr>
        </table>
      </div>


      <div class="backtext">
        <h1>Practice</h1>
      </div>

      <p id="name" class="text-in-background" [title]="_user.user.name">{{ _user.user.name }}</p>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>